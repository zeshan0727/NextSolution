name: Generate Movie Pages

on:
  workflow_dispatch:
    inputs:
      batch_size:
        description: 'Number of movies per batch'
        required: false
        default: '250'
  push:
    paths:
      - 'movies.html'
      - 'movie-template.html'

jobs:
  generate:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'

    - name: Install dependencies
      run: npm init -y && npm install

    - name: Generate Movie Pages
      run: |
        # Create generator script
        cat > generate.js << 'EOF'
        // The Node.js script from Option 1 goes here
        EOF
        
        # Copy the full script content here
        # ... paste the entire Node.js script content ...

    - name: Commit and push generated pages
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add *.html
        git commit -m "Generate movie pages - $(date)" || echo "No changes to commit"
        git push
